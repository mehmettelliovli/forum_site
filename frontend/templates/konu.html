<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Konu Detay – Tellioglu Forum</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <div class="container">
    <header>tellioglu forum</header>
    <nav>
      <a href="{{ url_for('home') }}">anasayfa</a>
      <a href="{{ url_for('topics') }}">tartismalar</a>
      <a href="{{ url_for('members') }}">uyeler</a>
      {% if user.is_authenticated %}
        <a href="{{ url_for('profile') }}">profil</a>
        <a href="{{ url_for('logout') }}">çıkış</a>
      {% else %}
        <a href="{{ url_for('signup') }}">üye ol</a>
        <a href="{{ url_for('login') }}">giriş</a>
      {% endif %}
    </nav>
    <section class="topics-section">
      <h2>{{ post.title }}</h2>
      <div class="meta-info">
        <b>Kategori:</b> {{ post.category.name }}<br>
        <b>Yazar:</b> {{ post.author.username }}<br>
        <b>Tarih:</b> {{ post.created_at.strftime('%d.%m.%Y %H:%M') }}<br>
        <b>Beğeni:</b> {{ post.likes|length }}
        {% if user.is_authenticated %}
          <form action="{{ url_for('like_post', post_id=post.id) }}" method="post" style="display:inline;">
            {% set liked = post.likes|selectattr('user_id', 'equalto', user.id)|list|length > 0 %}
            <button type="submit">{% if liked %}Beğeniyi Geri Al{% else %}Beğen{% endif %}</button>
          </form>
        {% endif %}
      </div>
      <div class="topic-content">{{ post.content }}</div>
      <hr>
      <h3>Yorumlar</h3>
      {% for comment in post.comments %}
        <div class="comment">
          <div class="comment-meta">{{ comment.user.username }} – {{ comment.created_at.strftime('%d.%m.%Y %H:%M') }}</div>
          <div class="comment-content">{{ comment.content }}</div>
        </div>
        <hr>
      {% else %}
        <p>Henüz yorum yok.</p>
      {% endfor %}
      {% if user.is_authenticated %}
      <h4>Yorum Ekle</h4>
      <form action="" method="post">
        <textarea name="comment_content" rows="3" required></textarea><br>
        <button type="submit">Yorum Yap</button>
      </form>
      {% else %}
        <p>Yorum yapmak için giriş yapmalısınız.</p>
      {% endif %}
    </section>
  </div>
</body>
</html> 